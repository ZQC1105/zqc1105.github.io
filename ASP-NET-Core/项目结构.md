# ASP.NET Core Web API 项目文件夹组织结构图

## 标准项目结构（Clean Architecture 风格）

```
MySolution/
├── src/
│   ├── MyProject.API/                          # 表现层 (Presentation Layer)
│   │   ├── Controllers/                        # API 控制器
│   │   │   ├── v1/                            # API 版本1
│   │   │   │   ├── UsersController.cs
│   │   │   │   ├── ProductsController.cs
│   │   │   │   └── OrdersController.cs
│   │   │   └── v2/                            # API 版本2
│   │   │       └── UsersController.cs
│   │   ├── Middleware/                        # 自定义中间件
│   │   │   ├── ErrorHandlingMiddleware.cs
│   │   │   ├── RequestLoggingMiddleware.cs
│   │   │   └── JwtMiddleware.cs
│   │   ├── Filters/                           # Action 过滤器
│   │   │   ├── ValidateModelAttribute.cs
│   │   │   ├── AuthorizeAttribute.cs
│   │   │   └── AuditLogAttribute.cs
│   │   ├── Extensions/                        # 启动扩展
│   │   │   ├── ServiceExtensions.cs
│   │   │   ├── SwaggerExtensions.cs
│   │   │   └── DatabaseExtensions.cs
│   │   ├── Program.cs                         # 程序入口
│   │   └── appsettings.json                   # 配置文件
│   │
│   ├── MyProject.Application/                  # 应用层 (Application Layer)
│   │   ├── Features/                           # CQRS 特性文件夹
│   │   │   ├── Users/                         # 用户相关特性
│   │   │   │   ├── Commands/                  # 命令
│   │   │   │   │   ├── CreateUser/
│   │   │   │   │   │   ├── CreateUserCommand.cs
│   │   │   │   │   │   ├── CreateUserCommandHandler.cs
│   │   │   │   │   │   └── CreateUserCommandValidator.cs
│   │   │   │   │   ├── UpdateUser/
│   │   │   │   │   └── DeleteUser/
│   │   │   │   ├── Queries/                   # 查询
│   │   │   │   │   ├── GetUserById/
│   │   │   │   │   ├── GetUsers/
│   │   │   │   │   └── SearchUsers/
│   │   │   │   └── DTOs/                      # 数据传输对象
│   │   │   │       ├── UserDto.cs
│   │   │   │       ├── CreateUserDto.cs
│   │   │   │       └── UpdateUserDto.cs
│   │   │   ├── Products/
│   │   │   └── Orders/
│   │   ├── Common/                            # 公共组件
│   │   │   ├── Behaviors/                     # MediatR 行为
│   │   │   │   ├── LoggingBehavior.cs
│   │   │   │   ├── ValidationBehavior.cs
│   │   │   │   └── PerformanceBehavior.cs
│   │   │   ├── Interfaces/                    # 应用层接口
│   │   │   │   ├── ICurrentUserService.cs
│   │   │   │   ├── IDateTimeService.cs
│   │   │   │   └── IEmailService.cs
│   │   │   ├── Mappings/                      # AutoMapper 配置
│   │   │   │   └── MappingProfile.cs
│   │   │   ├── Exceptions/                    # 业务异常
│   │   │   │   ├── NotFoundException.cs
│   │   │   │   ├── ValidationException.cs
│   │   │   │   └── BusinessException.cs
│   │   │   └── Helpers/                       # 帮助类
│   │   │       ├── PaginationHelper.cs
│   │   │       └── StringHelper.cs
│   │   └── DependencyInjection.cs             # 依赖注入配置
│   │
│   ├── MyProject.Domain/                       # 领域层 (Domain Layer)
│   │   ├── Entities/                           # 领域实体
│   │   │   ├── User.cs
│   │   │   ├── Product.cs
│   │   │   ├── Order.cs
│   │   │   ├── OrderItem.cs
│   │   │   └── Address.cs
│   │   ├── ValueObjects/                       # 值对象
│   │   │   ├── Email.cs
│   │   │   ├── Money.cs
│   │   │   └── Address.cs
│   │   ├── Enums/                              # 枚举
│   │   │   ├── UserRole.cs
│   │   │   ├── OrderStatus.cs
│   │   │   └── ProductCategory.cs
│   │   ├── Events/                             # 领域事件
│   │   │   ├── UserCreatedEvent.cs
│   │   │   ├── OrderPlacedEvent.cs
│   │   │   └── ProductStockChangedEvent.cs
│   │   ├── Specifications/                     # 规格模式
│   │   │   ├── ActiveUsersSpecification.cs
│   │   │   └── HighValueOrdersSpecification.cs
│   │   └── Interfaces/                         # 领域服务接口
│   │       ├── IUserRepository.cs
│   │       ├── IProductRepository.cs
│   │       └── IOrderRepository.cs
│   │
│   └── MyProject.Infrastructure/               # 基础设施层 (Infrastructure Layer)
│       ├── Persistence/                        # 数据持久化
│       │   ├── Context/                        # DbContext
│       │   │   ├── ApplicationDbContext.cs
│       │   │   └── ApplicationDbContextSeed.cs
│       │   ├── Repositories/                   # 仓储实现
│       │   │   ├── UserRepository.cs
│       │   │   ├── ProductRepository.cs
│       │   │   └── OrderRepository.cs
│       │   ├── Configurations/                 # 实体配置
│       │   │   ├── UserConfiguration.cs
│       │   │   ├── ProductConfiguration.cs
│       │   │   └── OrderConfiguration.cs
│       │   └── Migrations/                     # EF Core 迁移
│       │       ├── 20240101000000_Initial.cs
│       │       └── ApplicationDbContextModelSnapshot.cs
│       │
│       ├── Services/                           # 基础设施服务
│       │   ├── EmailService.cs                 # 邮件服务实现
│       │   ├── DateTimeService.cs              # 时间服务实现
│       │   ├── FileStorageService.cs           # 文件存储服务
│       │   └── SmsService.cs                   # 短信服务
│       │
│       ├── Identity/                           # 身份认证
│       │   ├── JwtTokenService.cs
│       │   ├── PasswordHasher.cs
│       │   └── CurrentUserService.cs
│       │
│       ├── Caching/                            # 缓存
│       │   ├── RedisCacheService.cs
│       │   └── MemoryCacheService.cs
│       │
│       ├── External/                           # 外部服务集成
│       │   ├── PaymentGatewayService.cs
│       │   ├── ShippingService.cs
│       │   └── SmsGatewayService.cs
│       │
│       └── DependencyInjection.cs              # 基础设施层DI配置
│
├── tests/                                      # 测试项目
│   ├── MyProject.API.Tests/                    # API 集成测试
│   │   ├── Controllers/
│   │   │   ├── UsersControllerTests.cs
│   │   │   └── ProductsControllerTests.cs
│   │   ├── Integration/
│   │   │   └── BaseIntegrationTest.cs
│   │   └── appsettings.Test.json
│   │
│   ├── MyProject.Application.Tests/            # 应用层单元测试
│   │   ├── Features/
│   │   │   ├── Users/
│   │   │   │   ├── CreateUserCommandTests.cs
│   │   │   │   └── GetUserQueryTests.cs
│   │   │   └── Products/
│   │   └── Common/
│   │       └── Behaviors/
│   │
│   ├── MyProject.Domain.Tests/                 # 领域层单元测试
│   │   ├── Entities/
│   │   │   └── UserTests.cs
│   │   └── ValueObjects/
│   │       └── EmailTests.cs
│   │
│   └── MyProject.Infrastructure.Tests/         # 基础设施层测试
│       ├── Persistence/
│       │   └── Repositories/
│       └── Services/
│
└── MySolution.sln                              # 解决方案文件
```

## 传统三层架构（更简单的项目结构）

```
MyProject.API/
├── Controllers/                                # API 控制器
│   ├── UsersController.cs
│   ├── ProductsController.cs
│   └── OrdersController.cs
├── Models/                                     # 数据模型
│   ├── Entities/                              # 实体类
│   │   ├── User.cs
│   │   ├── Product.cs
│   │   └── Order.cs
│   ├── DTOs/                                  # 数据传输对象
│   │   ├── Requests/                          # 请求DTO
│   │   │   ├── CreateUserRequest.cs
│   │   │   └── UpdateProductRequest.cs
│   │   └── Responses/                         # 响应DTO
│   │       ├── UserResponse.cs
│   │       └── ApiResponse.cs
│   └── ViewModels/                            # 视图模型
├── Services/                                   # 业务逻辑层
│   ├── Interfaces/                            # 服务接口
│   │   ├── IUserService.cs
│   │   ├── IProductService.cs
│   │   └── IAuthService.cs
│   ├── UserService.cs                         # 服务实现
│   ├── ProductService.cs
│   ├── AuthService.cs
│   └── Validators/                            # 验证器
│       ├── UserValidator.cs
│       └── ProductValidator.cs
├── Repositories/                               # 数据访问层
│   ├── Interfaces/                            # 仓储接口
│   │   ├── IUserRepository.cs
│   │   └── IProductRepository.cs
│   ├── UserRepository.cs                      # 仓储实现
│   ├── ProductRepository.cs
│   └── Base/                                  # 基础仓储
│       └── GenericRepository.cs
├── Data/                                       # 数据库上下文
│   ├── ApplicationDbContext.cs
│   ├── Configurations/                        # 实体配置
│   │   ├── UserConfiguration.cs
│   │   └── ProductConfiguration.cs
│   └── Migrations/                            # 数据库迁移
├── Middleware/                                 # 自定义中间件
│   ├── ExceptionMiddleware.cs
│   ├── LoggingMiddleware.cs
│   └── JwtMiddleware.cs
├── Filters/                                    # Action 过滤器
│   ├── ValidationFilter.cs
│   ├── AuthorizeFilter.cs
│   └── AuditLogFilter.cs
├── Helpers/                                    # 辅助类
│   ├── JwtHelper.cs
│   ├── PasswordHasher.cs
│   └── EmailHelper.cs
├── Extensions/                                 # 扩展方法
│   ├── ServiceExtensions.cs
│   ├── SwaggerExtensions.cs
│   └── ClaimsPrincipalExtensions.cs
├── Common/                                     # 公共组件
│   ├── Constants/                             # 常量
│   │   ├── Roles.cs
│   │   └── Policies.cs
│   ├── Exceptions/                            # 异常类
│   │   ├── ApiException.cs
│   │   └── NotFoundException.cs
│   └── Enums/                                 # 枚举
│       ├── UserRole.cs
│       └── OrderStatus.cs
├── Program.cs                                  # 程序入口
├── Startup.cs                                  # 启动配置（.NET 5及以前）
├── appsettings.json                           # 配置文件
├── appsettings.Development.json
└── Properties/
    └── launchSettings.json
```

## 微服务项目结构（DDD 风格）

```
MyMicroservice/
├── src/
│   ├── MyMicroservice.API/                     # API Gateway/入口
│   ├── MyMicroservice.Domain/                  # 领域层
│   │   ├── Aggregates/                         # 聚合根
│   │   │   ├── OrderAggregate/
│   │   │   │   ├── Order.cs
│   │   │   │   ├── OrderItem.cs
│   │   │   │   └── IOrderRepository.cs
│   │   │   └── UserAggregate/
│   │   ├── Entities/                           # 实体
│   │   ├── ValueObjects/                       # 值对象
│   │   ├── Events/                             # 领域事件
│   │   ├── Services/                           # 领域服务
│   │   └── Specifications/                     # 规格
│   │
│   ├── MyMicroservice.Application/              # 应用层
│   │   ├── UseCases/                           # 用例
│   │   ├── Commands/                           # 命令
│   │   ├── Queries/                            # 查询
│   │   ├── EventHandlers/                      # 事件处理器
│   │   └── DTOs/                               # 数据传输对象
│   │
│   ├── MyMicroservice.Infrastructure/           # 基础设施层
│   │   ├── Persistence/                        # 持久化
│   │   ├── MessageBus/                         # 消息总线
│   │   ├── Cache/                              # 缓存
│   │   ├── ExternalServices/                   # 外部服务
│   │   └── Identity/                           # 身份认证
│   │
│   └── MyMicroservice.Contracts/               # 共享契约
│       ├── Commands/                           # 命令契约
│       ├── Events/                             # 事件契约
│       └── DTOs/                               # DTO契约
│
├── tests/
│   ├── UnitTests/                              # 单元测试
│   ├── IntegrationTests/                       # 集成测试
│   └── ContractTests/                          # 契约测试
│
├── docker/                                     # Docker 配置
│   ├── Dockerfile
│   └── docker-compose.yml
│
├── k8s/                                        # Kubernetes 配置
│   ├── deployment.yaml
│   ├── service.yaml
│   └── ingress.yaml
│
└── scripts/                                    # 部署脚本
    ├── deploy.sh
    └── migrate.sh
```

## 按功能组织的模块化结构

```
MyProject/
├── Modules/                                     # 功能模块
│   ├── Identity/                               # 身份认证模块
│   │   ├── Controllers/
│   │   ├── Models/
│   │   ├── Services/
│   │   ├── Repositories/
│   │   └── DTOs/
│   │
│   ├── Catalog/                                # 商品目录模块
│   │   ├── Controllers/
│   │   ├── Models/
│   │   ├── Services/
│   │   └── Repositories/
│   │
│   ├── Ordering/                               # 订单模块
│   │   ├── Controllers/
│   │   ├── Models/
│   │   ├── Services/
│   │   └── Repositories/
│   │
│   └── Payment/                                # 支付模块
│       ├── Controllers/
│       ├── Models/
│       ├── Services/
│       └── Repositories/
│
├── Core/                                       # 核心共享组件
│   ├── Common/                                 # 公共组件
│   ├── Exceptions/                             # 异常处理
│   ├── Helpers/                                # 工具类
│   └── Extensions/                             # 扩展方法
│
├── Infrastructure/                             # 基础设施
│   ├── Database/                               # 数据库
│   ├── Cache/                                  # 缓存
│   ├── MessageQueue/                           # 消息队列
│   └── ExternalServices/                       # 外部服务
│
└── API/                                        # API 入口
    ├── Middleware/
    ├── Filters/
    ├── Program.cs
    └── appsettings.json
```

## 关键文件夹说明：

### **必选文件夹**：

1. **Controllers** - API 端点定义
2. **Models/Entities** - 数据模型
3. **Services** - 业务逻辑实现
4. **Repositories** - 数据访问抽象

### **推荐文件夹**：

1. **DTOs** - 数据传输对象，分离 API 契约和领域模型
2. **Middlewares** - 自定义中间件，统一处理逻辑
3. **Filters** - Action 过滤器，预处理/后处理请求
4. **Helpers/Utilities** - 通用工具类
5. **Extensions** - 扩展方法
6. **Common/Constants** - 常量和配置

### **高级项目可选**：

1. **Domain** - 领域层（DDD）
2. **Application** - 应用层（Clean Architecture）
3. **Infrastructure** - 基础设施层
4. **Events/EventHandlers** - 事件驱动架构
5. **BackgroundJobs** - 后台任务
6. **HealthChecks** - 健康检查

## 选择建议：

### **小型项目**：使用传统三层架构

- 一个项目内分层
- 快速启动，易于维护
- 适合团队规模小、需求简单的项目

### **中型项目**：使用 Clean Architecture

- 分离关注点清晰
- 易于测试和维护
- 适合长期发展、需求复杂的项目

### **大型项目/微服务**：使用 DDD + Clean Architecture

- 领域驱动设计
- 每个微服务独立
- 适合大型分布式系统

### **快速原型**：使用模块化结构

- 按功能组织
- 便于功能扩展
- 适合敏捷开发

**推荐**：对于大多数企业级应用，建议从**Clean Architecture**开始，随着项目增长可以平滑过渡到更复杂的架构。
