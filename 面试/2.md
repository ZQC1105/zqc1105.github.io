# C# 面试题目分类

## 一、C# 语法和新特性 (50 题)

### 初级题目 (15 题)

**1. C# 中值类型和引用类型有什么区别？**

```
值类型直接存储数据，分配在栈上，包括基本类型、结构体和枚举。
引用类型存储数据的内存地址，分配在堆上，包括类、接口、数组、字符串等。
值类型赋值是复制整个数据，引用类型赋值是复制引用地址。
```

**2. 什么是装箱和拆箱？**

```
装箱是将值类型转换为引用类型（object或接口）的过程，涉及内存分配和复制。
拆箱是将引用类型转换回值类型的过程，需要显式类型转换。
两者都有性能开销，应尽量避免。
```

**3. C# 中 string 和 StringBuilder 的区别？**

```
string 是不可变的，每次修改都会创建新对象，适合少量字符串操作。
StringBuilder 是可变的，内部使用字符数组，适合大量字符串拼接和修改。
```

**4. 抽象类和接口的区别？**

```
- 抽象类可以有实现，接口只能有声明（C# 8.0前）
- 类只能继承一个抽象类，但可以实现多个接口
- 抽象类用于"是什么"的关系，接口用于"能做什么"的关系
- 抽象类可以有字段，接口不能有实例字段
```

**5. C# 中的访问修饰符有哪些？**

```
public: 完全公开
private: 仅当前类内访问
protected: 当前类和派生类访问
internal: 同一程序集内访问
protected internal: 同一程序集或派生类访问
private protected: 同一程序集中的派生类访问（C# 7.2）
```

**6. 什么是静态类？有什么特点？**

```
使用 static 关键字声明的类，特点：
- 不能被实例化
- 只能包含静态成员
- 不能被继承
- 密封的（隐含sealed）
```

**7. 什么是扩展方法？如何定义？**

```
扩展方法允许为现有类型添加新方法而无需修改原始类型。
定义方式：静态类中的静态方法，第一个参数使用 this 关键字修饰。
```

**8. C# 中 readonly 和 const 的区别？**

```
const: 编译时常量，必须在声明时初始化，只能是内置类型。
readonly: 运行时常量，可以在声明时或构造函数中初始化，可以是任意类型。
const 是静态的，readonly 可以是实例成员。
```

**9. 什么是委托？**

```
委托是类型安全的函数指针，用于封装方法引用。
可以用于实现回调函数、事件处理等。
```

**10. 什么是匿名方法？**

```
匿名方法允许在不定义单独方法的情况下内联定义委托。
使用 delegate 关键字定义，可以访问外部变量。
```

**11. C# 中 using 关键字有哪些用途？**

```
1. 引用命名空间
2. 创建别名
3. 实现 IDisposable 接口的对象自动清理
4. using static（C# 6.0）: 导入静态类的成员
```

**12. 什么是 nullable 类型？**

```
使用 ? 修饰的值类型，表示可以存储 null 值。
如 int? nullableInt = null;
实际上是 System.Nullable<T> 的语法糖。
```

**13. C# 中如何实现多态？**

```
通过虚方法（virtual）、抽象方法（abstract）、接口（interface）实现。
运行时根据对象实际类型调用相应方法。
```

**14. 什么是属性？与字段的区别？**

```
属性是字段的封装，提供 get 和 set 访问器。
区别：属性可以包含逻辑验证，支持数据绑定；字段直接存储数据。
```

**15. 什么是索引器？**

```
允许对象像数组一样使用索引访问。
定义类似属性，但使用 this 关键字和参数列表。
```

### 中级题目 (20 题)

**16. 什么是泛型？有什么优点？**

```
泛型允许在编译时定义类型参数。
优点：
- 类型安全，避免装箱拆箱
- 代码重用
- 性能更好
- 更好的代码可读性
```

**17. 什么是协变和逆变？**

```
协变（out）：允许使用派生程度更大的类型
逆变（in）：允许使用派生程度更小的类型
C# 4.0 引入对接口和委托的协变逆变支持。
```

**18. 什么是 LINQ？有哪些类型？**

```
语言集成查询，提供统一的数据查询语法。
类型：
- LINQ to Objects（查询集合）
- LINQ to SQL（查询数据库）
- LINQ to XML（查询XML）
- LINQ to Entities（查询Entity Framework）
```

**19. 什么是 lambda 表达式？**

```
匿名函数的简洁写法，使用 => 运算符。
格式：(参数) => 表达式 或 (参数) => { 语句块 }
```

**20. 什么是表达式树？**

```
表达式树是代码的内存表示，可以在运行时分析、修改和执行。
主要用于 LINQ 查询转换（如 LINQ to SQL）。
```

**21. 什么是 yield 关键字？**

```
用于创建迭代器，简化迭代器的实现。
yield return 返回序列中的下一个元素
yield break 终止迭代
```

**22. 什么是异步编程的 async/await？**

```
async/await 简化异步编程模型。
async 标记方法为异步，await 等待异步操作完成而不阻塞线程。
```

**23. 什么是 Task 和 Task<T>？**

```
Task 表示一个异步操作。
Task<T> 表示返回值的异步操作。
提供丰富的 API 控制异步操作。
```

**24. 什么是并行编程？**

```
Parallel 类提供并行循环和任务执行。
PLINQ 提供并行 LINQ 查询。
Task Parallel Library (TPL) 提供任务并行库。
```

**25. 什么是反射？有什么用途？**

```
反射允许在运行时检查类型信息、创建对象、调用方法等。
用途：插件系统、序列化、ORM、依赖注入等。
```

**26. 什么是特性（Attribute）？**

```
用于为代码元素添加元数据的声明性标签。
可以自定义特性，通过反射读取。
```

**27. 什么是动态类型（dynamic）？**

```
C# 4.0 引入，绕过编译时类型检查，在运行时解析。
主要用于 COM 互操作和动态语言集成。
```

**28. 什么是元组（Tuple）？**

```
轻量级数据结构，用于存储多个值。
C# 7.0 引入值元组，性能更好，语法更简洁。
```

**29. 什么是模式匹配？**

```
C# 7.0 引入，增强 is 和 switch 语句的类型检查功能。
包括类型模式、常量模式、var 模式等。
```

**30. 什么是本地函数？**

```
在方法内部定义的方法，提高代码封装性。
可以访问包含方法的所有局部变量。
```

**31. 什么是 ref 返回值？**

```
C# 7.0 允许方法返回引用。
使用 ref 关键字，可以返回数组元素或字段的引用。
```

**32. 什么是 readonly 结构体？**

```
C# 7.2 引入，声明为 readonly 的结构体。
所有字段必须是 readonly，保证不可变性。
```

**33. 什么是 nullable 引用类型？**

```
C# 8.0 引入，帮助避免空引用异常。
需要显式声明引用类型是否可为 null。
```

**34. 什么是默认接口方法？**

```
C# 8.0 允许接口包含方法实现。
用于向现有接口添加新功能而不破坏现有实现。
```

**35. 什么是范围（Range）和索引（Index）？**

```
C# 8.0 引入的新语法：
Index: ^ 表示从末尾开始的索引
Range: .. 表示范围
```

### 高级题目 (15 题)

**36. 什么是内存泄漏？C# 中如何避免？**

```
虽然 .NET 有垃圾回收，但仍可能发生内存泄漏：
1. 事件处理程序未取消注册
2. 静态集合持有对象引用
3. 非托管资源未释放
4. 循环引用（特别是涉及事件）
避免：及时释放资源，使用弱引用，正确实现 Dispose 模式。
```

**37. 什么是垃圾回收？工作原理？**

```
.NET 自动管理内存，回收不再使用的对象。
分代回收：0代（新对象）、1代、2代（老对象）
垃圾回收器运行时暂停所有线程（Stop-the-world）。
```

**38. 什么是弱引用？用途？**

```
WeakReference 允许对象被垃圾回收器回收，即使有引用。
用途：缓存、监听器模式、避免内存泄漏。
```

**39. 什么是代码契约（Code Contracts）？**

```
前置条件、后置条件和不变量声明。
帮助进行静态验证和运行时检查。
```

**40. 什么是 SIMD？**

```
单指令多数据，并行处理多个数据。
System.Numerics 命名空间提供向量类型。
```

**41. 什么是栈分配数组（stackalloc）？**

```
在栈上分配数组，避免堆分配。
用于高性能场景，但大小有限制。
```

**42. 什么是不安全代码（unsafe）？**

```
允许使用指针，直接操作内存。
需要 unsafe 上下文和相应权限。
```

**43. 什么是 COM 互操作？**

```
与 COM 组件交互的技术。
通过 RCW（运行时可调用包装器）调用 COM 对象。
```

**44. 什么是 C# 源生成器？**

```
C# 9.0 引入，在编译时生成源代码。
用于减少样板代码，提高性能。
```

**45. 什么是记录类型（record）？**

```
C# 9.0 引入，不可变的数据类型。
自动实现值相等性、ToString() 等。
```

**46. 什么是顶级语句？**

```
C# 9.0 引入，简化控制台应用程序。
无需 Main 方法和类声明。
```

**47. 什么是模式匹配增强？**

```
C# 9.0 引入关系模式、逻辑模式等。
C# 10.0 增强属性模式。
```

**48. 什么是全局 using 指令？**

```
C# 10.0 引入，在整个项目中应用 using。
减少重复代码。
```

**49. 什么是文件范围的命名空间？**

```
C# 10.0 引入，简化命名空间声明。
无需大括号，适用于整个文件。
```

**50. 什么是 required 成员？**

```
C# 11.0 引入，要求属性必须在对象初始化时设置。
用于确保对象完整性。
```

## 二、EF Core 相关 (20 题)

### 初级题目 (8 题)

**1. 什么是 Entity Framework Core？**

```
微软的 ORM（对象关系映射）框架，将数据库表映射为.NET对象。
支持 Code First、Database First、Model First 开发方式。
```

**2. Code First、Database First、Model First 的区别？**

```
Code First: 从代码类生成数据库
Database First: 从现有数据库生成模型类
Model First: 从设计器模型生成数据库和代码（EF Core 不支持）
```

**3. 什么是 DbContext？**

```
数据库会话，代表与数据库的连接。
用于查询、跟踪更改、保存数据等操作。
```

**4. 什么是 DbSet？**

```
表示数据库中的表，用于执行 CRUD 操作。
DbContext 中的属性，对应实体集合。
```

**5. 如何配置实体关系？**

```
三种关系：
- 一对一：HasOne().WithOne()
- 一对多：HasOne().WithMany()
- 多对多：HasMany().WithMany()（需要连接表）
```

**6. 什么是迁移（Migration）？**

```
将代码模型更改同步到数据库的过程。
命令：Add-Migration, Update-Database, Remove-Migration
```

**7. 如何执行查询？**

```
- LINQ 查询：context.Users.Where(u => u.Age > 18)
- 原生 SQL：context.Users.FromSqlRaw()
- 存储过程：context.Users.FromSqlInterpolated()
```

**8. 什么是延迟加载和急切加载？**

```
延迟加载：首次访问导航属性时加载相关数据
急切加载：使用 Include() 一次性加载相关数据
显式加载：使用 Load() 方法显式加载
```

### 中级题目 (7 题)

**9. 什么是变更跟踪？**

```
DbContext 跟踪实体状态变化。
状态：Added, Modified, Deleted, Unchanged, Detached
SaveChanges() 时应用更改。
```

**10. 如何提高查询性能？**

```
- 使用 AsNoTracking() 关闭变更跟踪
- 使用 Select() 只查询需要的字段
- 正确使用 Include() 避免 N+1 查询
- 使用分页
- 使用索引
```

**11. 什么是并发控制？如何实现？**

```
处理多个用户同时修改同一数据。
实现方式：
- 乐观并发：使用并发令牌（时间戳、RowVersion）
- 悲观并发：使用事务和锁
```

**12. 如何执行原生 SQL？**

```
context.Database.ExecuteSqlRaw() - 执行非查询
context.Set<T>().FromSqlRaw() - 执行查询
使用参数化查询防止 SQL 注入。
```

**13. 什么是 Fluent API 和数据注解？**

```
两种配置方式：
- 数据注解：在实体类上使用特性
- Fluent API：在 OnModelCreating 中配置
Fluent API 更强大，不污染实体类。
```

**14. 如何实现软删除？**

```
1. 实体添加 IsDeleted 字段
2. 重写 SaveChanges() 将删除改为更新
3. 使用全局查询过滤器：modelBuilder.Entity<T>().HasQueryFilter(e => !e.IsDeleted)
```

**15. 什么是值对象和拥有实体？**

```
值对象：没有标识符，描述实体的某个方面
拥有实体：使用 OwnsOne() 或 OwnsMany() 配置
两者都映射到所有者实体的表中。
```

### 高级题目 (5 题)

**16. 什么是拦截器（Interceptor）？**

```
拦截和修改 EF Core 操作。
类型：DbCommandInterceptor, DbConnectionInterceptor, SaveChangesInterceptor
用于日志、审计、重试逻辑等。
```

**17. 什么是批量操作？如何优化？**

```
批量操作减少数据库往返次数。
优化：
- 使用 AddRange()/RemoveRange()
- 第三方库：EF Core.BulkExtensions, Z.EntityFramework.Extensions
- ExecuteSqlRaw 批量执行
```

**18. 什么是复杂类型（Complex Type）？**

```
C# 8.0 引入，类似值对象但没有自己的标识。
使用 [Owned] 特性或 OwnsOne() 配置。
```

**19. 如何实现多租户？**

```
1. 共享数据库，共享架构：使用查询过滤器
2. 共享数据库，独立架构：使用不同 DbContext
3. 独立数据库：使用不同连接字符串
```

**20. 什么是 DbContext 池？**

```
重用 DbContext 实例，提高性能。
services.AddDbContextPool<MyContext>()
注意：DbContext 状态会保留，需要手动重置。
```

## 三、ASP.NET Core 相关 (30 题)

### 初级题目 (10 题)

**1. 什么是 ASP.NET Core？**

```
跨平台、高性能、开源的Web框架。
内置依赖注入、配置系统、日志系统等。
```

**2. 什么是 Startup 类？**

```
配置服务和请求管道的类。
包含 ConfigureServices() 和 Configure() 方法。
```

**3. 什么是中间件（Middleware）？**

```
处理HTTP请求和响应的组件。
组成请求管道，按顺序执行。
```

**4. 什么是依赖注入？如何配置？**

```
设计模式，解耦组件依赖。
配置：在 Startup.ConfigureServices() 中注册服务。
生命周期：Singleton, Scoped, Transient。
```

**5. 什么是 Razor 页面？**

```
简化页面为中心的开发模型。
将页面和逻辑放在一起（PageModel）。
```

**6. 什么是 MVC 模式？**

```
Model-View-Controller 设计模式。
Model: 数据和业务逻辑
View: 用户界面
Controller: 处理用户输入
```

**7. 什么是路由？如何配置？**

```
将URL映射到控制器和动作。
配置方式：约定路由、属性路由、端点路由。
```

**8. 什么是模型绑定？**

```
将HTTP请求数据绑定到方法参数。
支持查询字符串、表单数据、路由数据、请求体等。
```

**9. 什么是模型验证？**

```
使用数据注解验证模型数据。
[Required], [StringLength], [Range], [RegularExpression] 等。
```

**10. 什么是视图和布局？**

```
视图：显示数据的模板（.cshtml）
布局：共享的页面框架（_Layout.cshtml）
部分视图：可重用的UI组件。
```

### 中级题目 (10 题)

**11. 什么是过滤器（Filter）？类型？**

```
在请求管道特定阶段执行的代码。
类型：Authorization, Resource, Action, Exception, Result
```

**12. 什么是身份认证和授权？**

```
认证：验证用户身份
授权：检查用户权限
方案：Cookies, JWT, OAuth, OpenID Connect
```

**13. 什么是 JWT 认证？**

```
JSON Web Token，无状态认证方案。
包含三部分：头部、载荷、签名。
```

**14. 什么是 SignalR？**

```
实时Web功能库，支持服务器到客户端推送。
使用 WebSocket、Server-Sent Events、长轮询。
```

**15. 什么是健康检查？**

```
监控应用程序健康状况。
配置：AddHealthChecks()，支持自定义检查。
```

**16. 什么是配置系统？来源？**

```
键值对配置系统。
来源：appsettings.json、环境变量、命令行、用户密钥等。
```

**17. 什么是日志系统？**

```
内置日志API，支持多种日志提供程序。
级别：Trace, Debug, Information, Warning, Error, Critical
```

**18. 什么是选项模式（Options Pattern）？**

```
配置类的强类型访问方式。
使用 IOptions<T>, IOptionsSnapshot<T>, IOptionsMonitor<T>
```

**19. 什么是响应缓存？**

```
缓存服务器响应，提高性能。
类型：客户端缓存、服务器端缓存、响应缓存中间件。
```

**20. 什么是 Web API？特点？**

```
构建 RESTful 服务的框架。
特点：无状态、使用HTTP方法、返回JSON/XML。
```

### 高级题目 (10 题)

**21. 什么是 gRPC？**

```
高性能 RPC 框架，基于 HTTP/2 和 Protocol Buffers。
支持双向流、流控制、头部压缩。
```

**22. 什么是 GraphQL？**

```
API 查询语言，客户端指定需要的数据。
避免过度获取和获取不足问题。
```

**23. 什么是后台服务（Background Service）？**

```
长时间运行的后台任务。
继承 BackgroundService 类，实现 ExecuteAsync()。
```

**24. 什么是托管服务（Hosted Service）？**

```
应用程序启动时启动的服务。
用于后台处理、消息队列消费等。
```

**25. 什么是健康检查发布者？**

```
将健康检查结果发布到外部系统。
如：Application Insights、Prometheus。
```

**26. 什么是速率限制（Rate Limiting）？**

```
限制客户端请求频率，防止滥用。
ASP.NET Core 7.0 内置支持。
```

**27. 什么是最小 API？**

```
ASP.NET Core 6.0 引入，简化API创建。
使用更少的样板代码，提高性能。
```

**28. 什么是端点路由终结点？**

```
ASP.NET Core 3.0 引入的新路由系统。
统一 MVC、Razor Pages、SignalR、gRPC 路由。
```

**29. 什么是服务器发送事件（SSE）？**

```
服务器向客户端单向推送事件。
用于实时通知、进度更新等。
```

**30. 什么是 API 版本控制？**

```
管理 API 不同版本，避免破坏性更改。
方式：URL路径、查询字符串、请求头、媒体类型。
```

---

这些题目涵盖了 C# 开发的主要领域，从基础语法到高级特性，从 EF Core 数据访问到 ASP.NET Core Web 开发，可以帮助面试官全面评估候选人的技术水平。题目难度分级，可以根据职位要求选择相应级别的问题。
